<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>D3 learning</title>
    <script src="d3/d3.js" charset="utf-8"></script>
    <style media="screen">
    			.axis path,
    			.axis line {
    				fill: none;
    				stroke: black;
    				shape-rendering: geometricPrecision;
    			}

                path
                {
                    stroke: steelblue;
                    stroke-width: 2;
                    fill: none;
                }

    			.axis text {
    				font-family: sans-serif;
    				font-size: 11px;
    			}

                .line {
                    fill: none;
                    stroke: steelblue;
                    stroke-width: 1.5px;
                }
    </style>
</head>
<body>
    <script type="text/javascript">
        var data = [
            {
                "month": 1,
                "num": 30
            },
            {
                "month": 3,
                "num": 50
            },
            {
                "month": 8,
                "num": 70
            },
            {
                "month": 12,
                "num": 100
            }
        ];

        var margin = {
            top: 20,
            right: 30,
            bottom: 30,
            left: 50
        };
        var w = 500;
        var h = 500;
        var mainW = w - margin.left - margin.right;
        var mainH = h - margin.top - margin.bottom;

        //先创建一个svg
        var svg = d3.select("body")
                    .append("svg")
                    .attr("width", w)
                    .attr("height", h);
                    // .append("g")
                    // .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        //创建比例尺
        var xscale = d3.scale.linear()
                            .domain([0,12])
                            .range([0, mainW]);
        var yscale = d3.scale.linear()
                            .domain(d3.extent(data, function(d) {
                                return d.num;
                            }))
                            .range([mainH, 0]);

        //创建x轴和y轴
        var xAxis = d3.svg.axis()
                        .scale(xscale)
                        .orient("bottom")
                        .ticks("13");
        var yAxis = d3.svg.axis()
                        .scale(yscale)
                        .orient("left");

        //定义line
        var line = d3.svg.line()
            .interpolate("cardinal")
            .x(function(d) { return xscale(d.month); })
            .y(function(d) { return yscale(d.num); });

        //绑定数据
        svg.append("path")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
            .attr("d", line.tension(0.4)(data));

        svg.selectAll("text")
            .data(data)
            .enter()
            .append("text")
            .text(function(d) {
                console.log(d.num);
                return d.num;
            })
            .attr("x", function(d) {
                return margin.left + xscale(d.month);
            })
            .attr("y", function(d) {
                return margin.top + yscale(d.num);
            })
            .attr("font-family", "sans-serif")
            .attr("font-size", "15px")
            .attr("fill", "red");

        svg.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(" + margin.left + "," + ( h - margin.bottom ) + ")")
            .call(xAxis);
        svg.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
            .call(yAxis);
    </script>
</body>
</html>
